# Perfil para habilitar login con Apple
# Sustituye los placeholders por variables de entorno o valores seguros fuera del repo.
# Nota: no pongas `spring.profiles` aquí — este archivo ya es `application-apple.properties` y
# se activa cuando arrancas la app con el perfil `apple` (p.ej. `SPRING_PROFILES_ACTIVE=apple`).

# Registration: use provider id 'apple'
spring.security.oauth2.client.registration.apple.provider=apple
spring.security.oauth2.client.registration.apple.client-id=${APPLE_CLIENT_ID}
# El client-secret para Apple normalmente es un JWT firmado (private_key_jwt). Aquí se espera
# que pongas el JWT generado en la variable de entorno APPLE_CLIENT_SECRET.
spring.security.oauth2.client.registration.apple.client-secret=${APPLE_CLIENT_SECRET}
spring.security.oauth2.client.registration.apple.client-name=Apple
spring.security.oauth2.client.registration.apple.scope=name,email
spring.security.oauth2.client.registration.apple.client-authentication-method=private_key_jwt
spring.security.oauth2.client.registration.apple.authorization-grant-type=authorization_code

# Provider endpoints de Apple
spring.security.oauth2.client.provider.apple.authorization-uri=https://appleid.apple.com/auth/authorize
spring.security.oauth2.client.provider.apple.token-uri=https://appleid.apple.com/auth/token
spring.security.oauth2.client.provider.apple.user-info-uri=https://appleid.apple.com/auth/userinfo
spring.security.oauth2.client.provider.apple.jwk-set-uri=https://appleid.apple.com/auth/keys
spring.security.oauth2.client.provider.apple.user-name-attribute=sub

# Metadatos adicionales (variables útiles para generar el client-secret JWT)
# APPLE_TEAM_ID: Team ID proporcionado por Apple
# APPLE_KEY_ID: Key ID de la clave privada (.p8) en el Apple Developer
# APPLE_PRIVATE_KEY_PATH: ruta local al archivo .p8 (fuera del repo)

# Nota importante:
# - Para Apple, el "client secret" es un JWT firmado con tu clave privada (algoritmo ES256).
# - Puedes generar ese JWT externamente y exponerlo en APPLE_CLIENT_SECRET como variable de entorno
#   antes de arrancar la app con el perfil 'apple'. El JWT debe expirar en un periodo razonable
#   (p.ej. 5 minutos a 6 meses según tu política) y cumplir los requisitos de Apple.

# Ejemplo de arranque (PowerShell):
# $env:APPLE_CLIENT_ID='tu-client-id'
# $env:APPLE_CLIENT_SECRET='(JWT generado)'
# $env:APPLE_TEAM_ID='TU_TEAM_ID'
# $env:APPLE_KEY_ID='TU_KEY_ID'
# $env:APPLE_PRIVATE_KEY_PATH='C:\secrets\AuthKey_ABC123DEF.p8'
# $env:SPRING_PROFILES_ACTIVE='test,apple'
# .\mvnw.cmd spring-boot:run

# Si quieres, te genero un pequeño utilitario Java para crear el JWT (usando Nimbus JOSE) y
# un script de ejemplo para generar el client-secret desde la clave .p8. Pídemelo y lo añado.
